(this["webpackJsonpstarnger-things"]=this["webpackJsonpstarnger-things"]||[]).push([[0],{35:function(e,t,s){"use strict";s.r(t);var n=s(1),c=s(17),r=s(4),a=s(7),i=s(5),o=s(3),j=s(2),l=function(){var e=Object(a.a)(Object(r.a)().mark((function e(t){var s,n,c,a,i,o,j;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.url,n=t.method,c=t.token,a=t.body,e.prev=1,i={method:n?n.toUpperCase():"GET",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},c&&(i.headers.Authorization="Bearer ".concat(c)),e.next=6,fetch("".concat("https://strangers-things.herokuapp.com/api/2208-FTB-ET-WEB-FT").concat(s),i);case 6:return o=e.sent,e.next=9,o.json();case 9:return(j=e.sent).error&&j.error,e.abrupt("return",j);case 14:e.prev=14,e.t0=e.catch(1),console.error(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),u=s(0),b=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),s=t[0],c=t[1],b=Object(n.useState)(""),O=Object(i.a)(b,2),g=O[0],S=O[1],N=Object(n.useState)(""),y=Object(i.a)(N,2),w=y[0],P=y[1],T=Object(n.useState)(""),C=Object(i.a)(T,2),D=(C[0],C[1]),E=Object(n.useState)([]),F=Object(i.a)(E,2),I=F[0],L=F[1],M=function(){var e=Object(a.a)(Object(r.a)().mark((function e(){var t,s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l({url:"/posts",token:g});case 2:t=e.sent,(s=t.data.posts)&&c(s);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){try{M()}catch(e){console.log(e)}}),[g]),Object(u.jsx)(o.a,{children:Object(u.jsxs)("div",{id:"container",children:[Object(u.jsxs)("div",{className:"navbar",children:[Object(u.jsx)(o.b,{className:"main-link",to:"/",children:"HOME"}),Object(u.jsx)(o.b,{className:"main-link",to:"/posts",children:"POSTS"}),g&&Object(u.jsx)(o.b,{className:"main-link",to:"/profile",children:"PROFILE"}),g?Object(u.jsx)(m,{setToken:S}):Object(u.jsx)(o.b,{className:"main-link",to:"/account/:method",children:"LOGIN/REGISTER"})]}),Object(u.jsx)(j.a,{exact:!0,path:"/",children:Object(u.jsx)(d,{username:w,token:g,posts:s})}),Object(u.jsxs)(j.a,{exact:!0,path:"/posts",children:[Object(u.jsx)(v,{posts:s,setPosts:c,fetchPosts:M}),Object(u.jsx)(p,{posts:s,token:g,fetchPosts:M,setPostId:D})]}),Object(u.jsx)(j.a,{exact:!0,path:"/addpost",children:Object(u.jsx)(f,{token:g,setPosts:c})}),Object(u.jsx)(j.a,{exact:!0,path:"/posts/:postId",children:Object(u.jsx)(k,{posts:s,token:g,fetchPosts:M})}),Object(u.jsx)(j.a,{exact:!0,path:"/profile",children:Object(u.jsx)(h,{token:g,messages:I,setMesaages:L,user:w})}),Object(u.jsx)(j.a,{exact:!0,path:"/account/:method",children:Object(u.jsx)(x,{setToken:S,setUser:P})})]})})},d=function(e){var t=e.username,s=e.token;return Object(u.jsxs)("div",{id:"welcome",children:[s?Object(u.jsx)("p",{className:"title",children:"Stranger Things"}):Object(u.jsx)("p",{className:"title",children:" Welcome to Stranger Things"}),s?Object(u.jsxs)("div",{className:"welcome-message",children:["Welcome! You are logged in as ",t,"!"]}):"",s?Object(u.jsx)(o.b,{className:"profile-link",to:"/profile",children:"View Profile"}):"",Object(u.jsx)("div",{className:"image",children:Object(u.jsx)("img",{className:"home-image",src:"https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/Stranger_Things_logo.png/640px-Stranger_Things_logo.png",alt:"Stranger Things Logo"})})]})},h=function(e){var t=e.token,s=e.messages,n=e.user,c=e.setMesaages,i=Object(j.e)(),o=function(){var e=Object(a.a)(Object(r.a)().mark((function e(){var s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l({url:"/users/me",token:t});case 2:s=e.sent,c(s.data.messages);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return t||i.push("/"),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h1",{children:"My Profile"}),Object(u.jsx)("form",{onSubmit:function(e){e.preventDefault(),o()},children:Object(u.jsx)("button",{type:"submit",children:"Click for Messages"})}),Object(u.jsx)("h2",{children:"Sent Messages"}),t?s.map((function(e,t){return Object(u.jsx)("div",{children:n===e.fromUser.username?Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("div",{children:[Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"Product Title: "}),'"',e.post.title,'" ']}),Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"Product ID: "}),e.post._id]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"Message: "}),e.content]}),Object(u.jsx)("hr",{})]})}):""},t)})):"",Object(u.jsx)("h2",{children:"Received Messages"}),t?s.map((function(e,t){return Object(u.jsx)("div",{children:n!==e.fromUser.username?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"Product Title: "}),'"',e.post.title,'" ']}),Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"Product ID: "}),e.post._id]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"Message: "}),e.content]}),Object(u.jsx)("hr",{})]}):""},t)})):""]})},O=function(e){var t=e.post,s=e.children;return t?Object(u.jsxs)("div",{className:"single-post",children:[Object(u.jsx)("h3",{children:Object(u.jsxs)("b",{children:["Seller's Username: ",t.author.username]})}),Object(u.jsx)("div",{children:Object(u.jsx)("b",{children:Object(u.jsx)("i",{children:t.title})})}),Object(u.jsxs)("div",{children:["Price: ",t.price?t.price:"[On Request]"]}),Object(u.jsxs)("div",{children:["Description: ",t.description]}),Object(u.jsxs)("div",{children:["Location: ",t.location?t.location:"[On Request]"]}),Object(u.jsxs)("div",{children:["Will Deliver? -- ",t.willDeliver?"yes":"no"]}),s]}):"Loading...."},p=function(e){var t=e.posts,s=(e.setPostId,e.token),n=e.fetchPosts,c=function(){var e=Object(a.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l({method:"DELETE",url:"/posts/".concat(t),token:s});case 2:return e.sent,e.next=5,n();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsxs)(u.Fragment,{children:[s?Object(u.jsx)(o.b,{className:"add-post-link",to:"/addpost",children:"Add Post"}):"",Object(u.jsx)("div",{className:"posts",children:t.map((function(e){return Object(u.jsxs)(O,{id:"all-posts",post:e,token:s,children:[Object(u.jsx)(o.b,{className:"details-link",to:"/posts/".concat(e._id),children:"Details"}),e.isAuthor&&Object(u.jsx)("button",{onClick:function(){return c(e._id)},children:"Delete Post"})]},e._id)}))})]})},x=function(e){var t=e.setToken,s=e.setUser,c=Object(n.useState)(""),b=Object(i.a)(c,2),d=b[0],h=b[1],O=Object(n.useState)(""),p=Object(i.a)(O,2),x=p[0],m=p[1],f=Object(j.f)(),v=Object(j.e)();return Object(u.jsx)(u.Fragment,{children:Object(u.jsx)("form",{method:"post",className:"form-container",onSubmit:function(){var e=Object(a.a)(Object(r.a)().mark((function e(n){var c,a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,l({url:"/users/".concat(f.method),method:"POST",body:{user:{username:d,password:x}}});case 3:if(!(c=e.sent).data){e.next=13;break}return e.next=7,l({url:"/users/me",token:c.data.token});case 7:if(a=e.sent,t(c.data.token),s(a.data.username),c.data.token&&v.push("/"),x){e.next=13;break}throw"wrong username or password";case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:Object(u.jsxs)("div",{className:"account-form",children:[Object(u.jsxs)("div",{className:"login-register-link",children:[Object(u.jsx)(o.b,{className:"links",to:"/account/login",children:"Login"}),Object(u.jsx)(o.b,{className:"links",to:"/account/register",children:"Register"})]}),Object(u.jsxs)("div",{className:"input-form",children:[Object(u.jsx)("input",{className:"inputs",type:"text",placeholder:"Enter Username",minLength:8,value:d,onChange:function(e){return h(e.target.value)}}),Object(u.jsx)("input",{className:"inputs",type:"password",placeholder:"Enter Password",minLength:8,value:x,onChange:function(e){return m(e.target.value)}})]}),Object(u.jsx)("div",{className:"submit-button",children:Object(u.jsx)("button",{className:"accountform-submit-button",type:"submit",children:"Submit"})})]})})})},m=function(e){var t=e.setToken;return Object(u.jsx)(o.b,{className:"main-link",to:"/",onClick:function(){return t("")},children:"logout"})},f=function(e){var t=Object(n.useState)(""),s=Object(i.a)(t,2),c=s[0],o=s[1],b=Object(n.useState)(""),d=Object(i.a)(b,2),h=d[0],O=d[1],p=Object(n.useState)(""),x=Object(i.a)(p,2),m=x[0],f=x[1],v=Object(n.useState)(""),g=Object(i.a)(v,2),k=g[0],S=g[1],N=Object(n.useState)(""),y=Object(i.a)(N,2),w=y[0],P=y[1],T=e.token,C=e.setPosts,D=Object(j.e)(),E=function(){var e=Object(a.a)(Object(r.a)().mark((function e(t){var s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,l({url:"/posts",method:"POST",body:{post:{title:c,price:h,description:m,location:k,willDeliver:w}},token:T});case 3:return e.sent,e.next=6,l({url:"/posts",token:T});case 6:s=e.sent,C(s.data.posts),o(""),O(""),f(""),s.data.posts&&D.push("/posts");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsx)(u.Fragment,{children:T&&Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"Add New Post"}),Object(u.jsxs)("form",{onSubmit:E,children:[Object(u.jsxs)("fieldset",{children:[Object(u.jsx)("label",{children:"Title: "}),Object(u.jsx)("input",{type:"text",placeholder:"*title*",value:c,onChange:function(e){o(e.target.value)}})]}),Object(u.jsxs)("fieldset",{children:[Object(u.jsx)("label",{children:"Price: "}),Object(u.jsx)("input",{type:"text",placeholder:"price",value:h,onChange:function(e){O(e.target.value)}})]}),Object(u.jsxs)("fieldset",{children:[Object(u.jsx)("label",{children:"Description: "}),Object(u.jsx)("input",{type:"text",placeholder:"description",value:m,onChange:function(e){f(e.target.value)}})]}),Object(u.jsxs)("fieldset",{children:[Object(u.jsx)("label",{children:"Location: "}),Object(u.jsx)("input",{type:"text",placeholder:"location",value:k,onChange:function(e){S(e.target.value)}})]}),Object(u.jsxs)("fieldset",{children:[Object(u.jsx)("label",{children:"Will Deliver? "}),Object(u.jsxs)("select",{type:"text",value:w,onChange:function(e){return P(e.target.value)},children:[Object(u.jsx)("option",{value:"",children:"Select"}),Object(u.jsx)("option",{value:"true",children:"Yes"}),Object(u.jsx)("option",{value:"false",children:"No"})]})]}),Object(u.jsx)("fieldset",{children:Object(u.jsx)("button",{className:"newpost-submit",type:"submit",children:"Submit"})})]})]})})},v=function(e){e.posts;var t=e.setPosts,s=e.fetchPosts,c=Object(n.useState)(""),r=Object(i.a)(c,2),a=r[0],o=r[1];return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("form",{className:"search-form",onSubmit:function(e){e.preventDefault(),function(){var e=post.filter((function(e){return function(e,t){return e.includes(t)}(e.title.toLowerCase(),a)}));t(e),a.length||s()}()},children:[Object(u.jsx)("input",{type:"text",placeholder:"search by title",className:"search-input",value:a,onChange:function(e){return o(e.target.value)}}),Object(u.jsx)("button",{type:"submit",className:"search-btn",children:"Enter"})]})})},g=function(e){var t=e.post,s=e.token,c=e.fetchPosts,o=Object(j.f)().postId,b=Object(n.useState)(""),d=Object(i.a)(b,2),h=d[0],O=d[1],p=function(){var e=Object(a.a)(Object(r.a)().mark((function e(t){var n;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,l({method:"POST",url:"/posts/".concat(o,"/messages"),token:s,body:{message:{content:h}}});case 3:return n=e.sent,O(n.data.message.content),e.next=7,c();case 7:O("");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsxs)(u.Fragment,{children:[s&&!t.isAuthor?Object(u.jsxs)("form",{onSubmit:p,children:[Object(u.jsx)("input",{value:h,placeholder:"content",onChange:function(e){return O(e.target.value)}}),Object(u.jsx)("button",{type:"submit",children:"Send Message"})]}):"",t.isAuthor&&t.messages.length?Object(u.jsxs)("form",{onSubmit:p,children:[Object(u.jsx)("input",{value:h,placeholder:"content",onChange:function(e){return O(e.target.value)}}),Object(u.jsx)("button",{type:"submit",children:"Send Message"})]}):""]})},k=function(e){var t=e.posts,s=e.token,n=e.fetchPosts,c=Object(j.f)().postId,r=t.find((function(e){return e._id===c}));return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)(O,{post:r,children:[r&&r.messages&&r.messages.map((function(e){return Object(u.jsxs)("div",{children:[e.fromUser.username,": ",e.content]},e._id)})),Object(u.jsx)(o.b,{className:"back-to-posts-link",to:"/posts",children:"Back"}),Object(u.jsx)(g,{post:r,token:s,fetchPosts:n})]})})};Object(c.createRoot)(document.getElementById("app")).render(Object(u.jsx)(b,{}))}},[[35,1,2]]]);
//# sourceMappingURL=main.172bdc2a.chunk.js.map